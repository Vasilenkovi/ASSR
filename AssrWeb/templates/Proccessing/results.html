{% extends "base.html" %}
{% load static %}
{% block content %}
{% block link %}
    <input type="hidden" id="taskPk" value="{{ task_pk }}">
    <script type="module" src="{% static 'js/visualization/getFigures.js' %}"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://mpld3.github.io/js/mpld3.v0.5.8.js"></script>
{% endblock %}
<h1>–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ <a href="{% url 'dataset:view_dataset' process.dataset.pk %}" > {{process.dataset.metadata.name}}</a> </h1>
<div class="status main-text">–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞: {{process.creationTime}}
<div class="status main-text">–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏: 
        {% if process.status == '2' %} –£—Å–ø–µ—Ö ‚úì
        {% elif process.status == '3' %} –ü—Ä–æ–≤–∞–ª ‚õî
        {% else %}–û–∂–∏–¥–∞–Ω–∏–µ üî•{% endif %}
</div>
<div class="mb-3">
    <a href="{% url 'processing:download' task_pk=task_pk %}?file_format=CSV" class="btn main-text btn-primary">
        –°–∫–∞—á–∞—Ç—å CSV
    </a>
    <a href="{% url 'processing:download' task_pk=task_pk %}?file_format=JSON" class="btn main-text btn-primary">
        –°–∫–∞—á–∞—Ç—å JSON
    </a>
</div>

{% if json_results %}
<div class="json-container" style="max-height: 700px;  max-width: 90%; overflow-y: auto; border: 1px solid #ccc; padding: 10px">
    <pre class="mb-0"><code>{{ json_results }}</code></pre>
</div>
{% else %}
<div class="alert alert-info">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤—ã</div>
{% endif %}
<div id="visualization-section" class="mt-4">
    <h3>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
    <button id="static-btn" class="btn btn-secondary">
        –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏
    </button>
    <button id="interactive-btn" class="btn btn-info">
        –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏
    </button>
    <div id="figures-container" class="row mt-3"></div>
</div>
{% endblock %}