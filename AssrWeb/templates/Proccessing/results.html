{% extends "base.html" %}
{% load static %}
{% block content %}
{% block link %}
    <input type="hidden" id="taskPk" value="{{ task_pk }}">
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.7.0/d3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mpld3@0.5.8/dist/mpld3.min.js"></script>
    <script src="{% static 'js/visualization/getFigures.js' %}"></script>
{% endblock %}
<h1>–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ <a href="{% url 'dataset:view_dataset' process.dataset.pk %}" > {{process.dataset.metadata.name}}</a> </h1>
<div class="status main-text">–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞: {{process.creationTime}}
<div class="status main-text">–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏: 
        {% if process.status == '2' %} –£—Å–ø–µ—Ö ‚úì
        {% elif process.status == '3' %} –ü—Ä–æ–≤–∞–ª ‚õî
        {% else %}–û–∂–∏–¥–∞–Ω–∏–µ üî•{% endif %}
</div>
<div class="mb-3">
    <a href="{% url 'processing:download' task_pk=task_pk %}?file_format=CSV" class="btn main-text btn-primary">
        –°–∫–∞—á–∞—Ç—å CSV
    </a>
    <a href="{% url 'processing:download' task_pk=task_pk %}?file_format=JSON" class="btn main-text btn-primary">
        –°–∫–∞—á–∞—Ç—å JSON
    </a>
</div>

{% if json_results %}
<div class="json-container" style="max-height: 700px;  max-width: 90%; overflow-y: auto; border: 1px solid #ccc; padding: 10px">
    <pre class="mb-0"><code>{{ json_results }}</code></pre>
</div>
{% else %}
<div class="alert alert-info">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤—ã</div>
{% endif %}

<style>
/* Fix the header color */
.card-header {
    color: #000 !important; /* Black color */
    font-size: 1.1rem;
    padding: 12px;
}

/* Responsive container for charts */
.chart-container {
    width: 100%;
    height: 500px;
    position: relative;
}

/* Reset internal padding for cards */
.card {
    margin: 0;
    border: 1px solid #ddd;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card-body {
    position: relative;
    height: 500px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}


</style>

<div id="visualization-section" class="mt-4" 
     data-show-distribution="true">
    <h3>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
    <select id="label-select" class="form-select mb-3" 
            style="max-width: 300px; display: none;">
        <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
    </select>
<button id="static-btn" class="btn btn-secondary me-2">–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏</button>
<button id="interactive-btn" class="btn btn-info">–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏</button>
<div id="figures-container" class="row mt-3"></div>

</div>
{% endblock %}